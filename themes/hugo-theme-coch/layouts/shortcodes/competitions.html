{{ $context := $.Page.Site.Params }}
{{ range sort .Site.Data.calendrier "date" "desc" }}

<section>
  <h3>
    {{ if gt now (dateFormat "2006-01-02" .limite) }}
    <s>
    {{ .title | markdownify }}
    </s>
    {{ else }}
    {{ .title | markdownify }}
    {{ end }}
  </h3>
  
  {{with .description }}
  <p>{{ . | markdownify }}</p>
  {{ end }}
  
  <ul>
    {{ with .date }}
    <li><strong>Date</strong> : {{ dateFormat "2006-01-02" . }}</li>
    {{ end }}
    {{ with .limite }}
    <li><strong>Date limite d'inscription</strong> : <mark>{{ dateFormat "2006-01-02" . }}</mark></li>
    {{ end }}
    {{ with .emplacement }}
    <li><strong>Emplacement</strong> : {{ .  | markdownify }}</li>
    {{ end }}
    {{ with .prix }}
    <li><strong>Prix</strong> : {{ replace . "." "," }}$</li>
    {{ end }}
    {{ with .information }}
    <li><strong><a href="{{ . }}" tagget="_blank">Informations sur la compétition</a></strong></li>
    {{ end }}
  </ul>

  {{ if gt now (dateFormat "2006-01-02" .limite) }}
  
  <div class="well">
    <span class="icon icon-warning"></span>
    <em>La date d'inscription est passée; le formulaire n'est plus disponible.</em>
  </div>
  {{ else }}

  <button
    class="btn btn-primary snipcart-add-item"
    data-item-id="{{ .id }}"
    data-item-name="{{ .title }}"
    data-item-price="{{ .prix }}"
    data-item-url="https://{{ if $context.isTest }}www-test.{{ end }}corsaire-chaparral.org/calendrier/"
    data-item-description="{{ with .location }}{{ . }}{{ end }}{{ with .date }} – Date: {{ dateFormat "2006-01-02" . }}{{ end }}">
        Payer ({{ replace .prix "." "," }}$)
  </button>
  
  {{ with .formulaire }}
  <h4>
    Formulaire
  </h4>
  {{ . | safeHTML }}
  {{ end }}
  {{ end }}

</section>

<hr>
{{ end }}
